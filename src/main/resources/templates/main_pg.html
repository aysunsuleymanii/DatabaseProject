<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>EasyFood</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"
          crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"
            crossorigin="anonymous"></script>
    <style>
        #cuisine {
            display: flex;
            overflow-x: auto;
            gap: 1rem;
            padding: 1rem;
            scroll-behavior: smooth;
        }

        #cuisine .card {
            flex: 0 0 auto;
            width: 7rem;
            height: 3rem;
            border-radius: 12px;
            cursor: pointer;
            transition: transform 0.2s;
        }

        #cuisine .card:hover {
            transform: scale(1.05);
        }

        /* Scrollbar */
        #cuisine::-webkit-scrollbar {
            height: 6px;
        }

        #cuisine::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }

        #cuisine::-webkit-scrollbar-thumb {
            background: #f0ad4e;
            border-radius: 10px;
        }

        #cuisine::-webkit-scrollbar-thumb:hover {
            background: #d9902e;
        }

        #cuisine {
            scrollbar-width: thin;
            scrollbar-color: #f0ad4e #f1f1f1;
        }

        /* This CSS is for the items-container now */
        .items-container .card,
        .recommended-scroll .card,
        .recommended-scroll-items .card {
            flex: 0 0 auto;
            width: 14rem;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s;
        }

        .items-container .card:hover,
        .recommended-scroll .card:hover,
        .recommended-scroll-items .card:hover {
            transform: scale(1.05);
        }

        .items-container img,
        .recommended-scroll img,
        .recommended-scroll-items img {
            height: 140px;
            object-fit: cover;
            border-top-left-radius: 12px;
            border-top-right-radius: 12px;
        }

        /* Cart badge styling */
        .cart-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            min-width: 18px;
            height: 18px;
            border-radius: 50%;
            font-size: 11px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1;
        }

        /* Hide badge when count is 0 */
        .cart-badge.d-none {
            display: none !important;
        }

        .recommended-scroll-items,
        .recommended-scroll,
        .items-scroll {
            display: flex;
            gap: 1rem;
            overflow-x: auto;
            padding-bottom: 1rem;
            scroll-behavior: smooth;
        }
    </style>
</head>
<body class="bg-light">

<nav class="navbar bg-body-tertiary shadow-sm">
    <div class="container-fluid">
        <a class="navbar-brand d-flex align-items-center" href="/home">
            <img src="/images/logo.JPG" alt="Logo" height="90" class="d-inline-block align-text-top">
        </a>
        <form th:action="@{/home}" method="get" class="d-flex mx-auto w-50" role="search">
            <input class="form-control me-2" type="search" name="searchTerm" th:value="${searchTerm}"
                   placeholder="Search for food..." aria-label="Search">
            <button class="btn btn-warning" type="submit">Search</button>
        </form>
        <div class="d-flex align-items-center gap-2">
            <a href="/cart" class="btn btn-outline-secondary rounded-circle p-2 position-relative d-flex align-items-center justify-content-center">
                <img src="https://cdn-icons-png.flaticon.com/512/1170/1170678.png" alt="Cart" width="22" height="22">
                <span class="cart-badge bg-warning text-dark"
                      th:classappend="${numberOfItems == 0} ? 'd-none' : ''"
                      th:text="${numberOfItems}">0</span>
            </a>
            <a href="/profile" class="btn btn-outline-secondary rounded-circle p-2 d-flex align-items-center justify-content-center">
                <img src="https://cdn-icons-png.flaticon.com/512/847/847969.png" alt="Profile" width="22" height="22">
            </a>
        </div>
    </div>
</nav>

<div class="text-center my-3">
    <blockquote class="blockquote">
        <p class="fs-5">"Fresh flavors delivered to your door."</p>
    </blockquote>
</div>

<div id="cuisine" class="container-fluid" th:if="${categories != null}">
    <a th:each="category : ${categories}"
       th:href="@{/home(categoryId=${category.id})}"
       class="card bg-warning d-flex justify-content-center align-items-center text-decoration-none text-dark">
        <h6 class="mb-0" th:text="${category.name}">Category Name</h6>
    </a>
</div>

<div th:if="${categories == null}">
    <p>No categories available.</p>
</div>

<div class="container-fluid my-4">
    <div class="items-container">
        <h4 th:if="${searchTerm} != null">Search Results for: <span th:text="${searchTerm}"></span></h4>
        <h4 th:unless="${searchTerm} != null">Featured Items</h4>

        <div class="recommended-scroll">
            <div class="card" th:each="item : ${items}">
                <img th:src="@{'/images/media/' + ${item.imageUrl}}" class="card-img-top" th:alt="${item.name}">
                <div class="card-body">
                    <h5 class="card-title" th:text="${item.name}">Item Name</h5>
                    <p class="card-text text-muted" th:text="${item.price} + '$'">Price</p>

                    <form th:action="@{/cart/add}" method="post">
                        <input type="hidden" name="itemId" th:value="${item.id}"/>
                        <button type="submit" class="btn btn-warning w-100">Add to cart</button>
                    </form>
                </div>
            </div>
            <div th:if="${items.isEmpty()}">
                <p>No results found.</p>
            </div>
        </div>
    </div>
</div>

<div id="RecommendedItems" class="container-fluid my-4"
     th:if="${recommendedItems != null and !recommendedItems.isEmpty()}">
    <h4 class="mb-3">Recommended for You</h4>
    <div class="recommended-scroll-items">
        <div class="card" th:each="item : ${recommendedItems}">
            <img th:src="@{'/images/media/' + ${item.imageUrl}}" class="card-img-top" th:alt="${item.name}">
            <div class="card-body">
                <h5 class="card-title" th:text="${item.name}">Item Name</h5>
                <p class="card-text text-muted" th:text="${item.price} + '$'">Price</p>

                <form th:action="@{/cart/add}" method="post">
                    <input type="hidden" name="itemId" th:value="${item.id}"/>
                    <button type="submit" class="btn btn-warning w-100">Add to cart</button>
                </form>
            </div>
        </div>
    </div>
</div>

</body>
</html>